name: Silta
recipe: drupal8

config:
  webroot: web
  via: nginx
  php: '7.1'
  database: mariadb:10.2

tooling:
  codeception:
    service: appserver
    description: Runs Codeception tests
    cmd: /app/vendor/bin/codecept
  phpcs:
    service: appserver
    description: Runs PHP_CodeSniffer using Drupal, DrupalPractice standards
    cmd: /app/vendor/bin/phpcs --standard=Drupal,DrupalPractice
  phpcbf:
    service: appserver
    description: Runs PHP Code Beautifier and Fixer using Drupal, DrupalPractice standards
    cmd: /app/vendor/bin/phpcbf --standard=Drupal,DrupalPractice
  phpstan:
    service: appserver
    description: Runs PHP Static Analysis Tool
    cmd: /app/vendor/bin/phpstan
  phpunit:
    service: appserver
    description: Runs PHPUnit tests
    cmd: /app/vendor/bin/phpunit
  cre:
    service: appserver
    description: Runs composer require
    cmd: composer require
  cup:
    service: appserver
    description: Runs composer update
    cmd: composer update --with-dependencies
  cupdc:
    service: appserver
    description: Runs composer update drupal/core webflo/drupal-core-require-dev --with-dependencies
    cmd: composer update drupal/core webflo/drupal-core-require-dev --with-dependencies

services:
  mailhog:
    type: mailhog
    hogfrom:
      - appserver

  appserver:
    overrides:
        environment:
          HASH_SALT: notsosecurehash

  # chrome:
  #   type: compose
  #   services:
  #     image: selenium/standalone-chrome
  #     volumes:
  #       - /dev/shm:/dev/shm
  #     ports:
  #       - "4444:4444"

proxy:
  mailhog:
    - mail.lndo.site

events:
  pre-start:
    - appserver: composer install
  # Clear caches after a database import
  post-db-import:
    - appserver: cd $LANDO_WEBROOT && drush cr -y

